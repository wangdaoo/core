<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reactive</title>
</head>
<body>
  <script src="../../dist/vue.global.js"></script>
  <div id="app">
    <div>ref source</div>
    <h1>{{ obj.count }}</h1>
    <button @click="obj.count++">count++</button>
    <button @click="obj.count--">count--</button>

    <div>shallowReactive source</div>
    <h1>{{ objShallow.count }}</h1>
    <button @click="objShallow.count++">count++</button>
    <button @click="objShallow.count--">count--</button>

    <div>shallowReactive child source</div>
    <h1>{{ objShallow.child.count }}</h1>
    <button @click="objShallow.child.count++">count++</button>
    <button @click="objShallow.child.count--">count--</button>
  </div>

  <script>
    const { reactive, isReactive, readonly, shallowReactive, toRaw, createApp } = Vue
    
    const objRaw = { count: 0 }

    // 将原始对象标记为不可转换
    // objRaw['__v_skip'] = true;
    // console.log(obj === objRaw) // true

    const obj = reactive(objRaw)

    console.log(isReactive(obj)) // true;

    // 将原始对象转换为只读对象
    // const ro = readonly(objRaw)
    // console.log(isReactive(ro)) // false;

    const objShallow = shallowReactive({
      count: 0,
      child: {
        count: 0
      }
    })

    console.log(isReactive(objShallow)) // true;

    const rawObj = reactive({ count: 1 });
    console.log(obj['__v_raw'] === rawObj) // false;
    console.log(toRaw(obj) === obj['__v_raw']) // true

    createApp({
      setup() {
        return { obj, objShallow }
      }
    }).mount('#app')
  </script>
</body>
</html>